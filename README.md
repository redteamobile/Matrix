# Matrix
Demo for gRPC

## 项目结构
```
Matrix
├── build.gradle
└── src
    ├── main
    │   ├── java
    │   │   └── package of java files
    │   ├── proto
    │   │   └── *.proto
    │   ├── protoGen
    │   │   └── package of java files which generated by protobuf
    │   └── resources
    └── test
```

## 使用protobuf生成对应java代码
`$> gradle clean generateProto`

## 实现rpc接口
```
@GRpcService
public class SomeYourService extends SomeGrpc.SomeImplBase {
    @Override
    public void yourMethod(SomeMessageRequest req, StreamObserver<SomeMessageReply> responseObserver) {
        // your logic here
        responseObserver.onNext(${value of class SomeMessageReply}); 
        responseObserver.onCompleted();
    }
}
```

## 实现rpc客户端
   1.Future 模式
```
 public Reply2ListBundle listBundle(String merchantCode) throws Exception {
        final ManagedChannel channel =
                ManagedChannelBuilder.forAddress(${YOUR_HOST}, ${YOUR_PORT}).usePlaintext(true).build();
        final GagaProviderGrpc.GagaProviderFutureStub stub = GagaProviderGrpc.newFutureStub(channel); // Future model
        ListenableFuture<Reply2ListBundle> reply = stub.listBundle(Request2ListBundle.newBuilder().setMerchantCode(merchantCode).build());

        while (true)
            if (reply.isDone()) {
                return reply.get();
            }
    }
```
